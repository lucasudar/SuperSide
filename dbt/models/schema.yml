version: 2

models:
  - name: stg_customers
    description: Dimensional customers table with deduplication
    columns:
      - name: id
        description: Unique identifier for a customer
        data_type: string
        data_tests:
          - unique
  - name: dim_projects
    description: Dimentional projects table

  - name: dim_customers
    description: Intermediate customers table
    config:
      always_create_constraint: true
    columns:
      - name: id
        description: Unique identifier for a customer
        data_type: string
        data_tests:
          - dbt_constraints.unique_key
      - name: customer_id
        description: Unique identifier for a customer
        data_tests:
          - dbt_utils.not_empty_string
      - name: revenue
        description: Revenue generated by the customer
        data_type: numeric
        data_tests:
          - dbt_utils.not_empty_string
      - name: service
        description: Service name
        data_type: string
        data_tests:
          - dbt_utils.not_empty_string
      - name: comments
        description: Comments about the customer
        data_type: string
        data_tests:
          - dbt_utils.not_empty_string
      - name: project_id
        description: Unique identifier for a project
        data_type: string
        data_tests:
          - dbt_utils.not_empty_string
      - name: project_ref
        description: Reference to the project
        data_type: string
        data_tests:
          - dbt_utils.not_empty_string
      - name: revenue_usd
        description: Revenue in USD
        data_type: numeric
        data_tests:
          - dbt_utils.not_empty_string
      - name: sub_service
        description: Sub-service name
        data_type: string
        data_tests:
          - dbt_utils.not_empty_string
      - name: engagementid
        description: Unique identifier for an engagement
        data_type: string
        data_tests:
          - dbt_utils.not_empty_string
      - name: service_type
        description: Type of service
        data_type: string
        data_tests:
          - dbt_utils.not_empty_string
      - name: customer_name
        description: Name of the customer
        data_type: string
        data_tests:
          - dbt_utils.not_empty_string
      - name: client_revenue
        description: Revenue generated by the client
        data_type: numeric
        data_tests:
          - not_null
          - dbt_utils.not_empty_string
      - name: employee_count
        description: Number of employees
        data_type: numeric
        data_tests:
          - dbt_utils.not_empty_string
      - name: engagement_date
        description: Date of engagement
        data_type: date
        data_tests:
          - not_null
          - dbt_utils.not_empty_string
      - name: engagement_type
        description: Type of engagement
        data_type: string
        data_tests:
          - dbt_utils.not_empty_string
      - name: detailed_sub_service
        description: Detailed sub-service name
        data_type: string
        data_tests:
          - not_null
          - dbt_utils.not_empty_string
      - name: engagement_reference
        description: Reference to the engagement
        data_type: string
        data_tests:
          - dbt_utils.not_empty_string

  - name: fct_revenue_projects
    description: Fact table for project revenue
    columns:
      - name: project_id
        description: Unique identifier for a project
        data_type: string
        data_tests:
          - not_null
          - dbt_utils.not_empty_string

  - name: mrt_project_revenue
    description: Materialized view for project revenue

